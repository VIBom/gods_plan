import{E as oe}from"./md-editor-v3.es.f0a37e60.js";/* empty css              */import{g as Ce,a as ue,s as Ie,_ as Te,b as we,c as ke}from"./gsApi.9a6cda08.js";import{a as ne}from"./request.583deb04.js";import{_ as Ve,d as Ae,r as f,e as g,x as Ee,o as p,c as C,b as s,f as t,w as a,j as L,g as o,G as I,F as U,A as T,i as _,S as se,B as J,U as ie,D as De,k as W,E as m,p as xe,a as Be}from"./index.4af51ece.js";const S=O=>(xe("data-v-f111900e"),O=O(),Be(),O),he={class:"update"},Ge={style:{margin:"10px 0"}},Me=W("\u6DFB\u52A0\u6587\u7AE0\u7C7B\u578B"),$e=W("\u5220\u9664\u6587\u7AE0"),Ue=W("\u7F16\u8F91\u6587\u7AE0"),Se=W("\u65B0\u589E\u6587\u7AE0\uFF08\u4E0D\u662F\u4FDD\u5B58\uFF01\uFF01\u6309\u4E0B\u540E\u4F1A\u91CD\u7F6E\u6240\u6709\u5185\u5BB9\uFF09"),Oe=S(()=>s("span",null,"Save",-1)),Re={class:"formClass"},Pe=["src"],ze={class:"content-button-wrapper"},qe=S(()=>s("span",null,"addType",-1)),Ne={class:"formClass"},je={class:"content-button-wrapper"},Le=S(()=>s("span",null,"Delete",-1)),Je={class:"formClass"},We={class:"content-button-wrapper"},He=S(()=>s("span",null,"Edit",-1)),Ke={class:"formClass"},Qe={class:"content-button-wrapper"},Xe=S(()=>s("span",null,"Save Editor",-1)),Ye={class:"formClass"},Ze=["src"],et={class:"content-button-wrapper"},tt=Ae({setup(O){const w=u=>{b.value=u,y.value=u,F.value=u,x.value=u,h.value=u},k=f(),re=async()=>{let u=await Ce();k.value=u.message},V=async u=>{if(u){let e=await ue({typeId:u});z.value=e.result}else{let e=await ue();z.value=e.result}};let A=f("save"),b=f(!1);const de=()=>{b.value=!0},d=g({articleTitle:"",typeId:"",articleContent:"",articleIMG:"",articleIntroduce:""}),R=f(),X=u=>{let e=u.file,c=new FormData;c.append("file",e),ne({method:"post",url:"http://www.godsplan.top/api/uploadImage/img",data:c,headers:{"Content-Type":"multipart/form-data"}}).then(i=>{i&&i.data.code===200?(A.value==="save"?d.articleIMG="http://www.godsplan.top/api/"+i.data.data:n.articleIMG="http://www.godsplan.top/api/"+i.data.data,m.success("\u56FE\u7247\u4E0A\u4F20\u6210\u529F\uFF01"),c="",K.value=[]):i&&i.msg?m.error(i.msg):m.error("\u56FE\u7247\u4E0A\u4F20\u5931\u8D25\uFF01")})},Y=u=>["image/jpeg","image/jpg","image/png","image/webp","image/gif"].indexOf(u.type)===-1?(m.error("\u4E0A\u4F20\u7684\u6587\u4EF6\u683C\u5F0F\u5FC5\u987B\u662FJPG\u3001JPEG\u3001PNG\u3001WEBP\u3001GIF!"),!1):u.size/1024/1024>2?(m.error("\u56FE\u7247\u5927\u5C0F\u4E0D\u80FD\u8D85\u8FC72MB!"),!1):!0,Z=g({articleTitle:[{required:!0,message:"Please input article title",trigger:"blur"}],typeId:[{required:!0,message:"Please select article type",trigger:"change"}]}),ee=async u=>{!u||await u.validate(async(e,c)=>{if(e)if(A.value==="save"){let i=T(d),r=await Ie(i);console.log(r),r.code===200?(b.value=!1,te(),m.success("\u4FDD\u5B58\u6210\u529F")):m.error("\u4FDD\u5B58\u5931\u8D25")}else{let i=T(n);(await Te(i)).code===200?(n.articleContent="",n.articleIMG="",n.articleIntroduce="",n.articleTitle="",n.creatTime="",n.id="",n.typeId="",n.views="",h.value=!1,m.success("\u7F16\u8F91\u4FDD\u5B58\u6210\u529F")):m.error("\u7F16\u8F91\u4FDD\u5B58\u5931\u8D25")}})},te=()=>{A.value="save",d.articleContent="",d.articleIMG="",d.articleTitle="",d.typeId="",d.articleIntroduce=""};let y=f(!1);const E=g({articleType:""}),le=f(),ce=g({articleType:[{required:!0,message:"Please input article type",trigger:"blur"}]}),pe=async u=>{!u||await u.validate(async(e,c)=>{if(e){let i=T(E),r=await we(i);r.code===200?m.success(r.message):m.error("\u6DFB\u52A0\u7C7B\u578B\u5931\u8D25"),y.value=!1,E.articleType=""}})};let F=f(!1);const D=g({typeId:"0"}),fe=()=>{F.value=!0,T(D.typeId)==="0"?V():V(T(D.typeId))},me=f(),P=u=>{V(u)},z=f([]),H=f(),ve=u=>{let e=u.map(c=>c.id).toString();H.value=e},_e=async()=>{H.value&&((await ke({id:H.value})).code==200?(m.success("\u5220\u9664\u6587\u7AE0\u6210\u529F"),F.value=!1):m.error("\u5220\u9664\u6587\u7AE0\u5931\u8D25\u4E86\uFF01"))},K=f([]),ae=async(u,e)=>{const c=await Promise.all(u.map(i=>new Promise((r,q)=>{const G=new FormData;G.append("file",i),ne.post("http://www.godsplan.top/api/uploadImage/img",G,{headers:{"Content-Type":"multipart/form-data"}}).then(v=>r(v)).catch(v=>q(v))})));e(c.map(i=>"http://www.godsplan.top/api/"+i.data.data))},x=f(!1),B=g({typeId:"0"}),ye=()=>{x.value=!0,T(B.typeId)==="0"?V():V(T(B.typeId))},n=g({articleTitle:"",typeId:"",articleContent:"",articleIMG:"",articleIntroduce:"",creatTime:"",id:"",views:""}),be=u=>{A.value="edit",u&&(n.articleTitle=u.articleTitle,n.typeId=u.typeId,n.articleContent=u.articleContent,n.articleIMG=u.articleIMG,n.articleIntroduce=u.articleIntroduce,n.id=u.id)},h=f(!1),Fe=()=>{h.value=!0};return Ee(()=>{re()}),(u,e)=>{const c=_("el-button"),i=_("el-input"),r=_("el-form-item"),q=_("el-icon"),G=_("el-upload"),v=_("el-option"),N=_("el-select"),M=_("el-form"),$=_("dialoge"),j=_("el-table-column");return p(),C(U,null,[s("div",he,[s("div",Ge,[t(c,{onClick:e[0]||(e[0]=l=>L(y)?y.value=!0:y=!0)},{default:a(()=>[Me]),_:1}),t(c,{onClick:fe},{default:a(()=>[$e]),_:1}),t(c,{onClick:ye},{default:a(()=>[Ue]),_:1}),t(c,{onClick:te},{default:a(()=>[Se]),_:1})]),o(A)==="save"?(p(),I(o(oe),{key:0,modelValue:o(d).articleContent,"onUpdate:modelValue":e[1]||(e[1]=l=>o(d).articleContent=l),class:"mdEditor",onOnSave:de,onOnUploadImg:ae,"toolbars-exclude":["github","pageFullscreen","fullscreen"]},null,8,["modelValue"])):(p(),I(o(oe),{key:1,modelValue:o(n).articleContent,"onUpdate:modelValue":e[2]||(e[2]=l=>o(n).articleContent=l),class:"mdEditor",onOnSave:Fe,onOnUploadImg:ae,"toolbars-exclude":["github","pageFullscreen","fullscreen"]},null,8,["modelValue"]))]),t($,{flag:o(b),onOnClick:w},{Title:a(()=>[Oe]),default:a(()=>[s("div",Re,[t(M,{ref_key:"ruleFormRef",ref:R,model:o(d),"status-icon":"",rules:o(Z),"label-width":"120px","label-position":"top",class:"demo-ruleForm"},{default:a(()=>[t(r,{label:"article Title",prop:"articleTitle"},{default:a(()=>[t(i,{modelValue:o(d).articleTitle,"onUpdate:modelValue":e[3]||(e[3]=l=>o(d).articleTitle=l)},null,8,["modelValue"])]),_:1}),t(r,{label:"article Introduce",prop:"articleIntroduce"},{default:a(()=>[t(i,{modelValue:o(d).articleIntroduce,"onUpdate:modelValue":e[4]||(e[4]=l=>o(d).articleIntroduce=l),autosize:"",type:"textarea"},null,8,["modelValue"])]),_:1}),t(r,{label:"article IMG"},{default:a(()=>[t(G,{class:"avatar-uploader",action:"#","http-request":X,limit:1,"show-file-list":!1,"auto-upload":!0,"before-upload":Y,"file-list":K.value},{default:a(()=>[o(d).articleIMG?(p(),C("img",{key:0,src:o(d).articleIMG,class:"avatar"},null,8,Pe)):(p(),I(q,{key:1,class:"avatar-uploader-icon"},{default:a(()=>[t(o(se))]),_:1}))]),_:1},8,["file-list"])]),_:1}),t(r,{label:"article Type",prop:"typeId"},{default:a(()=>[t(N,{modelValue:o(d).typeId,"onUpdate:modelValue":e[5]||(e[5]=l=>o(d).typeId=l),placeholder:"zone"},{default:a(()=>[(p(!0),C(U,null,J(k.value,(l,Q)=>(p(),I(v,{label:l.articleType,value:l.t_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),Footer:a(()=>[s("div",ze,[s("button",{class:"content-button status-button open close",onClick:e[6]||(e[6]=l=>L(b)?b.value=!1:b=!1)},"Cancel"),s("button",{class:"content-button status-button",onClick:e[7]||(e[7]=l=>ee(R.value))},"Continue")])]),_:1},8,["flag"]),t($,{flag:o(y),onOnClick:w},{Title:a(()=>[qe]),default:a(()=>[s("div",Ne,[t(M,{ref_key:"addTyperuleFormRef",ref:le,model:o(E),"status-icon":"",rules:o(ce),"label-width":"120px","label-position":"top",class:"demo-ruleForm"},{default:a(()=>[t(r,{label:"article Type",prop:"articleType"},{default:a(()=>[t(i,{modelValue:o(E).articleType,"onUpdate:modelValue":e[8]||(e[8]=l=>o(E).articleType=l)},null,8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),Footer:a(()=>[s("div",je,[s("button",{class:"content-button status-button open close",onClick:e[9]||(e[9]=l=>L(y)?y.value=!1:y=!1)},"Cancel"),s("button",{class:"content-button status-button",onClick:e[10]||(e[10]=l=>pe(le.value))},"Continue")])]),_:1},8,["flag"]),t($,{flag:o(F),onOnClick:w},{Title:a(()=>[Le]),default:a(()=>[s("div",Je,[t(M,{ref_key:"deleteAFormRef",ref:me,model:o(D),"status-icon":"","label-width":"120px","label-position":"top",class:"demo-ruleForm"},{default:a(()=>[t(r,{label:"article Type",prop:"typeId"},{default:a(()=>[t(N,{modelValue:o(D).typeId,"onUpdate:modelValue":e[12]||(e[12]=l=>o(D).typeId=l),placeholder:"zone"},{default:a(()=>[t(v,{label:"\u5168\u90E8",value:"0",onClick:e[11]||(e[11]=l=>P())}),(p(!0),C(U,null,J(k.value,(l,Q)=>(p(),I(v,{label:l.articleType,value:l.t_id,onClick:ge=>P(l.t_id)},null,8,["label","value","onClick"]))),256))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"articles",prop:"type"},{default:a(()=>[t(o(ie),{data:z.value,style:{width:"100%"},height:"300",onSelectionChange:ve},{default:a(()=>[t(j,{type:"selection",width:"55"}),t(j,{property:"articleTitle",label:"articleTitle"})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])])]),Footer:a(()=>[s("div",We,[s("button",{class:"content-button status-button open close",onClick:e[13]||(e[13]=l=>L(F)?F.value=!1:F=!1)},"Cancel"),s("button",{class:"content-button status-button",onClick:e[14]||(e[14]=l=>_e())},"Continue")])]),_:1},8,["flag"]),t($,{flag:x.value,onOnClick:w},{Title:a(()=>[He]),default:a(()=>[s("div",Ke,[t(M,{ref:"editAFormRef",model:o(B),"status-icon":"","label-width":"120px","label-position":"top",class:"demo-ruleForm"},{default:a(()=>[t(r,{label:"article Type",prop:"typeId"},{default:a(()=>[t(N,{modelValue:o(B).typeId,"onUpdate:modelValue":e[16]||(e[16]=l=>o(B).typeId=l),placeholder:"zone"},{default:a(()=>[t(v,{label:"\u5168\u90E8",value:"0",onClick:e[15]||(e[15]=l=>P())}),(p(!0),C(U,null,J(k.value,(l,Q)=>(p(),I(v,{label:l.articleType,value:l.t_id,onClick:ge=>P(l.t_id)},null,8,["label","value","onClick"]))),256))]),_:1},8,["modelValue"])]),_:1}),t(r,{label:"articles",prop:"type"},{default:a(()=>[t(o(ie),{data:z.value,style:{width:"100%"},height:"300","highlight-current-row":"",onCurrentChange:be},{default:a(()=>[t(j,{type:"index",width:"55"}),t(j,{property:"articleTitle",label:"articleTitle"})]),_:1},8,["data"])]),_:1})]),_:1},8,["model"])])]),Footer:a(()=>[s("div",Qe,[s("button",{class:"content-button status-button open close",onClick:e[17]||(e[17]=l=>x.value=!1)},"Cancel"),s("button",{class:"content-button status-button",onClick:e[18]||(e[18]=l=>x.value=!1)},"Continue")])]),_:1},8,["flag"]),t($,{flag:h.value,onOnClick:w},{Title:a(()=>[Xe]),default:a(()=>[s("div",Ye,[t(M,{ref_key:"ruleFormRef",ref:R,model:o(n),"status-icon":"",rules:o(Z),"label-width":"120px","label-position":"top",class:"demo-ruleForm"},{default:a(()=>[t(r,{label:"article Title",prop:"articleTitle"},{default:a(()=>[t(i,{modelValue:o(n).articleTitle,"onUpdate:modelValue":e[19]||(e[19]=l=>o(n).articleTitle=l)},null,8,["modelValue"])]),_:1}),t(r,{label:"article Introduce",prop:"articleIntroduce"},{default:a(()=>[t(i,{modelValue:o(n).articleIntroduce,"onUpdate:modelValue":e[20]||(e[20]=l=>o(n).articleIntroduce=l),autosize:"",type:"textarea"},null,8,["modelValue"])]),_:1}),t(r,{label:"article IMG"},{default:a(()=>[t(G,{class:"avatar-uploader",action:"#","http-request":X,limit:1,"show-file-list":!1,"auto-upload":!0,"before-upload":Y,"file-list":K.value},{default:a(()=>[o(n).articleIMG?(p(),C("img",{key:0,src:o(n).articleIMG,class:"avatar"},null,8,Ze)):De("",!0),t(q,{class:"avatar-uploader-icon"},{default:a(()=>[t(o(se))]),_:1})]),_:1},8,["file-list"])]),_:1}),t(r,{label:"article Type",prop:"typeId"},{default:a(()=>[t(N,{modelValue:o(n).typeId,"onUpdate:modelValue":e[21]||(e[21]=l=>o(n).typeId=l),placeholder:"zone"},{default:a(()=>[(p(!0),C(U,null,J(k.value,(l,Q)=>(p(),I(v,{label:l.articleType,value:l.t_id},null,8,["label","value"]))),256))]),_:1},8,["modelValue"])]),_:1})]),_:1},8,["model","rules"])])]),Footer:a(()=>[s("div",et,[s("button",{class:"content-button status-button open close",onClick:e[22]||(e[22]=l=>h.value=!1)},"Cancel"),s("button",{class:"content-button status-button",onClick:e[23]||(e[23]=l=>ee(R.value))},"Continue")])]),_:1},8,["flag"])],64)}}});var st=Ve(tt,[["__scopeId","data-v-f111900e"]]);export{st as default};
